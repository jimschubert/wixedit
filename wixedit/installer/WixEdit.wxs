<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs:      "<projectfile>" "..\install\Sources.wxs" -dVERSION=0.5.0
    lightArgs:     "<projectname>.wixobj" Sources.wixobj -out "<projectname>.msi"
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Product Name="WixEdit" Id="????????-????-????-????-????????????" Version="$(var.VERSION)" UpgradeCode="5D5D3F6C-20FE-487e-9836-542950FD7921" Manufacturer="Jasper Keuper (jkeuper@gmail.com)" Language="1033">
    <Package Compressed="yes" Id="????????-????-????-????-????????????" />
    <Condition Message="You must install the Microsoft .NET Framework SDK 1.1.4322 before running [ProductName] [Setup].">MsiNetAssemblySupport&gt;="1.1.4322"</Condition>
    <?include Dialogs.wxi?>
    <Property Id="VSDSupportedRuntimes">1.1.4322</Property>
    <Property Id="ARPHELPLINK">http://wixedit.sourceforge.net</Property>
    <Property Id="ARPCONTACT">Jasper Keuper (jkeuper@gmail.com)</Property>
    <Property Id="ARPURLINFOABOUT">http://wixedit.sourceforge.net</Property>
    <Property Id="ARPPRODUCTICON">WixEdit.Application.Icon</Property>
    <Directory Id="myTARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="TARGETDIR" Name="WixEdit">
          <Component Id="CsprojFile" DiskId="1" KeyPath="yes" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0000">
            <File Id="WixEdit.csproj" Name="WixEdit.csp" LongName="WixEdit.csproj" src="..\WixEdit.csproj" />
          </Component>
          <Component Id="BuildFile" DiskId="1" KeyPath="yes" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0001">
            <File Id="WixEdit.build" Name="WixEdit.bld" LongName="WixEdit.build" src="..\WixEdit.build" />
          </Component>
          <Component Id="WxsFileAssociation" DiskId="1" KeyPath="yes" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0017">
              <ProgId Id="WixEditFile.Association" Description="WixEdit Source File" Icon="[WixEditExe],0">
                <Extension Id="wxs" ContentType="text/xml">
                  <Verb Id="open" Sequence="10" Command="Open" Target="[!WixEditExe]" Argument="&quot;%1&quot;" />
                </Extension>
              </ProgId>
          </Component>
          <Directory Id="Binaries" Name="binaries">
            <Component Id="Binaries" DiskId="1" KeyPath="yes" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0002">
              <File Id="manifest" Name="WIXEDI_1.MAN" LongName="WixEdit.exe.manifest" src="..\build\WixEdit.exe.manifest" />
              <File Id="WixEditExe" Name="WIXEDI_1.EXE" LongName="WixEdit.exe" src="..\build\WixEdit.exe" />
              <!-- Include pdb so error reporting shows line numbers. -->
              <File Id="pdb" Name="WIXEDI_1.PDB" LongName="WixEdit.pdb" src="..\build\WixEdit.pdb" />
              <File Id="AxSHDocVw.dll" Name="AXSHDO_1.DLL" LongName="AxSHDocVw.dll" src="..\build\AxSHDocVw.dll" />
              <File Id="SHDocVw.dll" Name="SHDOCV_1.DLL" LongName="SHDocVw.dll" src="..\build\SHDocVw.dll" />
            </Component>
          </Directory>
          <Directory Id="Samples" Name="sample">
            <Directory Id="UISample" Name="uisample" LongName="UISample">
              <Component Id="Sample.UISample" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0003">
                <File Id="UISample.wxs" Name="UISAMPLE.WXS" LongName="UISample.wxs" src="..\sample\UISample\UISample.wxs" />
              </Component>
              <Directory Id="Binary" Name="Binary">
                <Component Id="Sample.UISample.Binary" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0004">
                  <File Id="bannrbmp.ibd" Name="BANNRBMP.IBD" LongName="bannrbmp.ibd" src="..\sample\UISample\Binary\bannrbmp.ibd" />
                  <File Id="completi.ibd" Name="COMPLETI.IBD" LongName="completi.ibd" src="..\sample\UISample\Binary\completi.ibd" />
                  <File Id="custicon.ibd" Name="CUSTICON.IBD" LongName="custicon.ibd" src="..\sample\UISample\Binary\custicon.ibd" />
                  <File Id="dlgbmp.ibd" Name="DLGBMP.IBD" LongName="dlgbmp.ibd" src="..\sample\UISample\Binary\dlgbmp.ibd" />
                  <File Id="exclamic.ibd" Name="EXCLAMIC.IBD" LongName="exclamic.ibd" src="..\sample\UISample\Binary\exclamic.ibd" />
                  <File Id="info.ibd" Name="INFO.IBD" LongName="info.ibd" src="..\sample\UISample\Binary\info.ibd" />
                  <File Id="insticon.ibd" Name="INSTICON.IBD" LongName="insticon.ibd" src="..\sample\UISample\Binary\insticon.ibd" />
                  <File Id="New.ibd" Name="NEW.IBD" LongName="New.ibd" src="..\sample\UISample\Binary\New.ibd" />
                  <File Id="removico.ibd" Name="REMOVICO.IBD" LongName="removico.ibd" src="..\sample\UISample\Binary\removico.ibd" />
                  <File Id="repairic.ibd" Name="REPAIRIC.IBD" LongName="repairic.ibd" src="..\sample\UISample\Binary\repairic.ibd" />
                  <File Id="Up.ibd" Name="UP.IBD" LongName="Up.ibd" src="..\sample\UISample\Binary\Up.ibd" />
                </Component>
              </Directory>
            </Directory>
            <Directory Id="DarkSample" Name="darksam" LongName="DarkSample">
              <Component Id="Sample.DarkSample" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0005">
                <File Id="UISample.msi" Name="UISAMPLE.MSI" LongName="UISample.msi" src="..\sample\DarkSample\UISample.msi" />
              </Component>
            </Directory>
            <Directory Id="SimpleSample" Name="simpsam" LongName="SimpleSample">
              <Component Id="Sample.SimpleSample" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0006">
                <File Id="SimpleSample.wxs" Name="SIMPSAMP.WXS" LongName="SimpleSample.wxs" src="..\sample\SimpleSample\SimpleSample.wxs" />
                <File Id="Test.txt" Name="TEST.TXT" LongName="Test.txt" src="..\sample\SimpleSample\Test.txt" />
              </Component>
            </Directory>
          </Directory>
          <Directory Id="WixBinaries" Name="WIX-2~1" LongName="wix-2.0.3719.0">
            <Component Id="WixBinaries" DiskId="1" KeyPath="yes" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0007">
              <File Id="CPL.TXT" Name="CPL.TXT" src="..\wix-2.0.3719.0\CPL.TXT" />
              <File Id="candle.exe" Name="candle.exe" src="..\wix-2.0.3719.0\candle.exe" />
              <File Id="candle.exe.config" Name="candle.cfg" LongName="candle.exe.config" src="..\wix-2.0.3719.0\candle.exe.config" />
              <File Id="dark.exe" Name="dark.exe" src="..\wix-2.0.3719.0\dark.exe" />
              <File Id="dark.exe.config" Name="dark.cfg" LongName="dark.exe.config" src="..\wix-2.0.3719.0\dark.exe.config" />
              <File Id="light.exe" Name="light.exe" src="..\wix-2.0.3719.0\light.exe" />
              <File Id="light.exe.config" Name="light.cfg" LongName="light.exe.config" src="..\wix-2.0.3719.0\light.exe.config" />
              <File Id="lit.exe" Name="lit.exe" src="..\wix-2.0.3719.0\lit.exe" />
              <File Id="lit.exe.config" Name="lit.cfg" LongName="lit.exe.config" src="..\wix-2.0.3719.0\lit.exe.config" />
              <File Id="tallow.exe" Name="tallow.exe" src="..\wix-2.0.3719.0\tallow.exe" />
              <File Id="tallow.exe.config" Name="tallow.cfg" LongName="tallow.exe.config" src="..\wix-2.0.3719.0\tallow.exe.config" />
              <File Id="mergemod.dll" Name="mergemod.dll" src="..\wix-2.0.3719.0\mergemod.dll" />
              <File Id="Microsoft.Tools.WindowsInstallerXml.NAntTasks.dll" Name="Micro123.dll" LongName="Microsoft.Tools.WindowsInstallerXml.NAntTasks.dll" src="..\wix-2.0.3719.0\Microsoft.Tools.WindowsInstallerXml.NAntTasks.dll" />
              <File Id="winterop.dll" Name="winterop.dll" src="..\wix-2.0.3719.0\winterop.dll" />
              <File Id="wix.dll" Name="wix.dll" src="..\wix-2.0.3719.0\wix.dll" />
              <File Id="WixTasks.dll" Name="WixTasks.dll" src="..\wix-2.0.3719.0\WixTasks.dll" />
              <File Id="wix.targets" Name="wix.tgt" LongName="wix.targets" src="..\wix-2.0.3719.0\wix.targets" />
            </Component>
            <Directory Id="WixBinaries.ca" Name="ca">
              <Component Id="WixBinaries.ca" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0008">
                <File Id="scaexec.dll" Name="scaexec.dll" src="..\wix-2.0.3719.0\ca\scaexec.dll" />
                <File Id="scasched.dll" Name="scasched.dll" src="..\wix-2.0.3719.0\ca\scasched.dll" />
                <File Id="wixca.dll" Name="wixca.dll" src="..\wix-2.0.3719.0\ca\wixca.dll" />
                <File Id="sca.wixlib" Name="SCA_1.WIX" LongName="sca.wixlib" src="..\wix-2.0.3719.0\ca\sca.wixlib" />
                <File Id="wixca.wixlib" Name="WIXCA_1.WIX" LongName="wixca.wixlib" src="..\wix-2.0.3719.0\ca\wixca.wixlib" />
              </Component>
            </Directory>
            <Directory Id="WixBinaries.doc" Name="doc">
              <Component Id="WixBinaries.doc" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0009">
                <File Id="WiX.chm" Name="WiX.chm" src="..\wix-2.0.3719.0\doc\WiX.chm" />
                <File Id="wix.xsd" Name="wix.xsd" src="..\wix-2.0.3719.0\doc\wix.xsd" />
                <File Id="wixloc.xsd" Name="wixloc.xsd" src="..\wix-2.0.3719.0\doc\wixloc.xsd" />
              </Component>
            </Directory>
            <Directory Id="WixBinaries.lib" Name="lib">
              <Component Id="WixBinaries.lib" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0010">
                <File Id="dutil.lib" Name="dutil.lib" src="..\wix-2.0.3719.0\lib\dutil.lib" />
              </Component>
              <Component Id="WixBinaries.ui" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0011">
                <File Id="wixui_featuretree.wixlib" Name="WIXUI_FT.WIX" LongName="wixui_featuretree.wixlib" src="..\wix-2.0.3719.0\lib\wixui_featuretree.wixlib" />
                <File Id="wixui_minimal.wixlib" Name="WIXUI_MI.WIX" LongName="wixui_minimal.wixlib" src="..\wix-2.0.3719.0\lib\wixui_minimal.wixlib" />
                <File Id="wixui_mondo.wixlib" Name="WIXUI_MO.WIX" LongName="wixui_mondo.wixlib" src="..\wix-2.0.3719.0\lib\wixui_mondo.wixlib" />
              </Component>
              <Component Id="WixBinaries.ui.bitmaps" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0012">
                <File Id="bannrbmp.bmp" Name="bannrbmp.bmp" src="..\wix-2.0.3719.0\lib\bannrbmp.bmp" />
                <File Id="dlgbmp.bmp" Name="dlgbmp.bmp" src="..\wix-2.0.3719.0\lib\dlgbmp.bmp" />
                <File Id="exclamic.ico" Name="exclamic.ico" src="..\wix-2.0.3719.0\lib\exclamic.ico" />
                <File Id="info.ico" Name="info.ico" src="..\wix-2.0.3719.0\lib\info.ico" />
                <File Id="New.ico" Name="New.ico" src="..\wix-2.0.3719.0\lib\New.ico" />
                <File Id="Up.ico" Name="Up.ico" src="..\wix-2.0.3719.0\lib\Up.ico" />
              </Component>
              <Component Id="WixBinaries.ui.Language" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0015">
                <File Id="WixUI_en_us.wxl" Name="WIXUI_1.wxl" LongName="WixUI_en-us.wxl" src="..\wix-2.0.3719.0\lib\WixUI_en-us.wxl" />
              </Component>
              <Component Id="WixBinaries.ui.License" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0016">
                <File Id="License.rtf" Name="License.rtf" src="..\wix-2.0.3719.0\lib\License.rtf" />
              </Component>
              <Directory Id="WixBinaries.ui.bitmaps" Name="Bitmaps">
              </Directory>
            </Directory>
          </Directory>
          <Directory Id="Templates" Name="template" LongName="templates">
            <Directory Id="TemplatesUISample" Name="uisample" LongName="UISample">
              <Component Id="Templates.UISample" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0013">
                <File Id="Templates.UISample.wxi" Name="UISAMPLE.WXI" LongName="UISample.wxi" src="..\templates\UISample\UISample.wxi" />
              </Component>
              <Directory Id="Templates.Binary" Name="Binary">
                <Component Id="Templates.UISample.Binary" DiskId="1" Guid="DEADBEEF-DEAD-BEEF-DEAD-BEEFDEAD0014">
                  <File Id="Templates.bannrbmp.bmp" Name="BANNRBMP.BMP" LongName="bannrbmp.bmp" src="..\templates\UISample\Binary\bannrbmp.bmp" />
                  <File Id="Templates.completi.ico" Name="COMPLETI.ICO" LongName="completi.ico" src="..\templates\UISample\Binary\completi.ico" />
                  <File Id="Templates.custicon.ico" Name="CUSTICON.ICO" LongName="custicon.ico" src="..\templates\UISample\Binary\custicon.ico" />
                  <File Id="Templates.dlgbmp.bmp" Name="DLGBMP.BMP" LongName="dlgbmp.bmp" src="..\templates\UISample\Binary\dlgbmp.bmp" />
                  <File Id="Templates.exclamic.ico" Name="EXCLAMIC.ICO" LongName="exclamic.ico" src="..\templates\UISample\Binary\exclamic.ico" />
                  <File Id="Templates.info.ico" Name="INFO.ICO" LongName="info.ico" src="..\templates\UISample\Binary\info.ico" />
                  <File Id="Templates.insticon.ico" Name="INSTICON.ICO" LongName="insticon.ico" src="..\templates\UISample\Binary\insticon.ico" />
                  <File Id="Templates.New.ico" Name="NEW.ICO" LongName="New.ico" src="..\templates\UISample\Binary\New.ico" />
                  <File Id="Templates.removico.ico" Name="REMOVICO.ICO" LongName="removico.ico" src="..\templates\UISample\Binary\removico.ico" />
                  <File Id="Templates.repairic.ico" Name="REPAIRIC.ICO" LongName="repairic.ico" src="..\templates\UISample\Binary\repairic.ico" />
                  <File Id="Templates.Up.ico" Name="UP.ICO" LongName="Up.ico" src="..\templates\UISample\Binary\Up.ico" />
                </Component>
              </Directory>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
    </Directory>
    <Feature Id="BinariesFeature" Level="1" Title="Binaries" ConfigurableDirectory="TARGETDIR" Absent="disallow" Description="The WixEdit binaries.">
      <ComponentRef Id="Binaries" />
    </Feature>
    <Feature Id="WxsAssociationFeature" Level="1" Title="File Association" Description="Associate .wxs files to WixEdit"><!-- ConfigurableDirectory="TARGETDIR" -->
      <ComponentRef Id="WxsFileAssociation" />
    </Feature>
    <Feature Id="TemplatesFeature" Level="1" Title="Templates" ConfigurableDirectory="TARGETDIR" Absent="disallow" Description="The WixEdit Templates to create new WiX files.">
      <ComponentRef Id="Templates.UISample" />
      <ComponentRef Id="Templates.UISample.Binary" />
    </Feature>
    <Feature Id="SourcesFeature" Level="1" Title="Sources" ConfigurableDirectory="TARGETDIR" Description="The WixEdit sources in C#, which can be build with NAnt or Visual Studio 2003.">
      <!-- Generated with tallow.exe -->
      <ComponentRef Id="CsprojFile" />
      <ComponentRef Id="BuildFile" />
      <ComponentRef Id="component0" />
      <ComponentRef Id="component1" />
      <ComponentRef Id="component2" />
      <ComponentRef Id="component3" />
      <ComponentRef Id="component4" />
      <ComponentRef Id="component5" />
      <ComponentRef Id="component6" />
      <ComponentRef Id="component7" />
      <ComponentRef Id="component8" />
      <ComponentRef Id="component9" />
      <ComponentRef Id="component10" />
      <ComponentRef Id="component11" />
      <ComponentRef Id="component12" />
      <ComponentRef Id="component13" />
      <ComponentRef Id="component14" />
      <ComponentRef Id="component15" />
    </Feature>
    <Feature Id="SamplesFeature" Title="Samples" Level="1" Display="expand" Description="WixEdit samples">
      <FeatureRef Id="SamplesFeature.UISample" />
      <FeatureRef Id="SamplesFeature.DarkSample" />
      <FeatureRef Id="SamplesFeature.SimpleSample" />
    </Feature>
    <Feature Id="SamplesFeature.UISample" Title="UI Sample" Level="1" ConfigurableDirectory="TARGETDIR" Description="A WixEdit sample with all kinds of dialogs.">
      <ComponentRef Id="Sample.UISample" />
      <ComponentRef Id="Sample.UISample.Binary" />
    </Feature>
    <Feature Id="SamplesFeature.DarkSample" Title="Dark Sample" Level="1" ConfigurableDirectory="TARGETDIR" Description="A WixEdit sample for decompiling msi installer files.">
      <ComponentRef Id="Sample.DarkSample" />
    </Feature>
    <Feature Id="SamplesFeature.SimpleSample" Title="Simple Sample" Level="1" ConfigurableDirectory="TARGETDIR" Description="A Simple WixEdit sample which installs one file only.">
      <ComponentRef Id="Sample.SimpleSample" />
    </Feature>
    <Feature Id="WixBinariesFeature" Level="1" Title="Wix 2.0.3220.0" ConfigurableDirectory="TARGETDIR" Description="The Wix binaries.">
      <ComponentRef Id="WixBinaries" />
      <ComponentRef Id="WixBinaries.ca" />
      <ComponentRef Id="WixBinaries.doc" />
      <ComponentRef Id="WixBinaries.lib" />
      <ComponentRef Id="WixBinaries.ui" />
      <ComponentRef Id="WixBinaries.ui.bitmaps" />
      <ComponentRef Id="WixBinaries.ui.Language" />
      <ComponentRef Id="WixBinaries.ui.License" />
    </Feature>
    <Upgrade Id="5D5D3F6C-20FE-487e-9836-542950FD7921">
      <!-- Upgrading everything before this version. -->
      <UpgradeVersion Maximum="$(var.VERSION)" Property="OLDERVERSIONFOUND" OnlyDetect="no" IncludeMaximum="no" />
      <!-- Denying everything from this version (with changed product Id) and up, because that would conflict with the component rules! -->
      <UpgradeVersion Minimum="$(var.VERSION)" Property="NEWERVERSIONFOUND" OnlyDetect="yes" IncludeMinimum="yes" />
    </Upgrade>
    <CustomAction Id="LaunchFile" FileKey="WixEditExe" ExeCommand="" Return="asyncNoWait" />
    <CustomAction Id="NewVersionError" Error="A newer version of [ProductName] is already installed! Cannot continue installation." />
    <Media Id="1" EmbedCab="yes" Cabinet="Files.cab" />
    <Icon Id="WixEdit.Application.Icon" SourceFile="..\res\dialog\source.ico" />
  </Product>
</Wix>